<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="ipynb_website:version" content="0.9.2" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="stylesheet" type="text/css" href="../css/jt.css">
<link rel="stylesheet" type="text/css" href="../css/toc2.css">
<link href="../site_libs/jqueryui-1.11.4/jquery-ui.css">
<link rel="stylesheet" href="../site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<link rel="stylesheet" href="../site_libs/font-awesome-4.5.0/css/font-awesome.min.css" rel="stylesheet" />
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.9.1/jquery-ui.min.js"></script>
<script src="../site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="../site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="../site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<link rel="stylesheet"
      href="../site_libs/highlight/textmate.css"
      type="text/css" />
<script src="../site_libs/highlight/highlight.js"></script>
<script type="text/javascript">
if (window.hljs && document.readyState && document.readyState === "complete") {
   window.setTimeout(function() {
      hljs.initHighlighting();
   }, 0);
}
</script>
<script src="../js/toc2.js"></script>
<script src="../js/docs.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS_HTML"></script>
<script>
    MathJax.Hub.Config({
        extensions: ["tex2jax.js"],
        jax: ["input/TeX", "output/HTML-CSS"],
        tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"] ],
        displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
        processEscapes: true
        },
        "HTML-CSS": {
            preferredFont: "TeX",
            availableFonts: ["TeX"],
            styles: {
                scale: 110,
                ".MathJax_Display": {
                    "font-size": "110%",
                }
            }
        }
    });
</script>
<script>
$( document ).ready(function(){
            var cfg={'threshold':3,     // depth of toc (number of levels)
             'number_sections': false,
             'toc_cell': false,          // useless here
             'toc_window_display': true, // display the toc window
             "toc_section_display": "block", // display toc contents in the window
             'sideBar':true,       // sidebar or floating window
             'navigate_menu':false       // navigation menu (only in liveNotebook -- do not change)
            }
            var st={};                  // some variables used in the script
            st.rendering_toc_cell = false;
            st.config_loaded = false;
            st.extension_initialized=false;
            st.nbcontainer_marginleft = $('#notebook-container').css('margin-left')
            st.nbcontainer_marginright = $('#notebook-container').css('margin-right')
            st.nbcontainer_width = $('#notebook-container').css('width')
            st.oldTocHeight = undefined
            st.cell_toc = undefined;
            st.toc_index=0;
            // fire the main function with these parameters
            table_of_contents(cfg, st);
            var file=analysisDict[$("h1:first").attr("id")];
            $("#toc-level0 a").css("color","#126dce");
            $('a[href="#'+$("h1:first").attr("id")+'"]').hide()
            var docs=analysisArray;
            var pos=analysisArray.indexOf(file);
            for (var a=pos;a>=0;a--){
                  var name=docs[a]
                  $('<li><a href="'+name+'.html"><font color="#073642"><b>'+name.replace(/_/g," ")+'</b></font></a></li>').insertBefore("#toc-level0 li:eq(0)");
            }
            $('a[href="'+file+'.html'+'"]').css("color","#126dce");
            for (var a=pos+1;a<docs.length;a++){
                  var name=docs[a]
                  $(".toc #toc-level0").append('<li><a href="'+name+'.html"><font color="#073642"><b>'+name.replace(/_/g," ")+'</b></font></a></li>');
            }
            $("#toc-header").hide();
    });
</script>
<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');
  // mark it active
  menuAnchor.parent().addClass('active');
  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>
<div class="container-fluid main-container">
<!-- tabsets -->
<script src="../site_libs/navigation-1.1/tabsets.js"></script>
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script><title>GTEx eQTL</title>
<style type = "text/css">
body {
  font-family: "Droid Sans";
  padding-top: 66px;
  padding-bottom: 40px;
}
</style>
</head>
<body>
<div tabindex="-1" id="notebook" class="border-box-sizing">
<div class="container" id="notebook-container">
<!-- code folding -->
<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">GTEx eQTL</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">Overview</a>
</li>
<li>
  <a href="../analysis.html">Analysis</a>
</li>
<li>
  <a href="../prototype.html">Prototype</a>
</li>
<li>
  <a href="../writeup.html">Writeup</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
   <a href="http://github.com/stephenslab/gtex-eqtls"> <span class="fa fa-github"></span> </a>
</li>
</ul>
      </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->
<div class='display_control_panel'>
        <div class="display_checkboxes">
        Show:
            &nbsp;
            <input type="checkbox" id="show_cells" name="show_cells" onclick="toggle_source()">
            <label for="show_cells">All cells</label>
            &nbsp;
            <input type="checkbox" id="show_prompt" name="show_prompt" onclick="toggle_prompt()">
            <label for="show_prompt">Prompt</label>
            &nbsp;
            <input type="checkbox" id="show_messages" name="show_messages" onclick="toggle_messages()">
            <label for="show_messages">Messages</label>
    </div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Analyzing-a-toy-example-with-varbvs-and-mr-ash">Analyzing a toy example with <code>varbvs</code> and <code>mr-ash</code><a class="anchor-link" href="#Analyzing-a-toy-example-with-varbvs-and-mr-ash">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In this example we analyze a data set where there is potentially multiple SNPs associated with gene expression. We use both <code>bvs</code> and <code>mr-ash</code> methods, initializing both of them with results from <code>lasso</code>.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Utility-functions">Utility functions<a class="anchor-link" href="#Utility-functions">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[1]:</div><div class="hidden_content">
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-r"><pre><span></span>autoselect.mixsd <span class="o">=</span> <span class="kr">function</span><span class="p">(</span>betahat<span class="p">,</span>sebetahat<span class="p">,</span>mult <span class="o">=</span> <span class="kp">sqrt</span><span class="p">(</span><span class="m">2</span><span class="p">)){</span>
        <span class="c1"># To avoid exact measure causing (usually by mistake)</span>
        sebetahat <span class="o">=</span> sebetahat<span class="p">[</span>sebetahat<span class="o">!=</span><span class="m">0</span><span class="p">]</span> 
        <span class="c1"># so that the minimum is small compared with measurement precision</span>
        sigmaamin <span class="o">=</span> <span class="kp">min</span><span class="p">(</span>sebetahat<span class="p">)</span><span class="o">/</span><span class="m">10</span> 
        <span class="kr">if</span> <span class="p">(</span><span class="kp">all</span><span class="p">(</span>betahat<span class="o">^</span><span class="m">2</span> <span class="o">&lt;=</span> sebetahat<span class="o">^</span><span class="m">2</span><span class="p">))</span> <span class="p">{</span>
            <span class="c1"># to deal with the occassional odd case where this could happen; 8 is arbitrary</span>
            sigmaamax <span class="o">=</span> <span class="m">8</span><span class="o">*</span>sigmaamin 
        <span class="p">}</span> <span class="kr">else</span> <span class="p">{</span>
            <span class="c1"># this computes a rough largest value you&#39;d want to use, </span>
            <span class="c1"># based on idea that sigmaamax^2 + sebetahat^2 should be at least betahat^2   </span>
            sigmaamax <span class="o">=</span> <span class="m">2</span><span class="o">*</span><span class="kp">sqrt</span><span class="p">(</span><span class="kp">max</span><span class="p">(</span>betahat<span class="o">^</span><span class="m">2</span><span class="o">-</span>sebetahat<span class="o">^</span><span class="m">2</span><span class="p">))</span> 
        <span class="p">}</span>
        <span class="kr">if</span><span class="p">(</span>mult<span class="o">==</span><span class="m">0</span><span class="p">){</span>
            <span class="kr">return</span><span class="p">(</span><span class="kt">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span>sigmaamax<span class="o">/</span><span class="m">2</span><span class="p">))</span>
        <span class="p">}</span> <span class="kr">else</span> <span class="p">{</span>
            npoint <span class="o">=</span> <span class="kp">ceiling</span><span class="p">(</span><span class="kp">log2</span><span class="p">(</span>sigmaamax<span class="o">/</span>sigmaamin<span class="p">)</span><span class="o">/</span><span class="kp">log2</span><span class="p">(</span>mult<span class="p">))</span>
            <span class="kr">return</span><span class="p">(</span>mult<span class="o">^</span><span class="p">((</span><span class="o">-</span>npoint<span class="p">)</span><span class="o">:</span><span class="m">0</span><span class="p">)</span> <span class="o">*</span> sigmaamax<span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>
univariate_regression <span class="o">=</span> <span class="kr">function</span><span class="p">(</span>X<span class="p">,</span>y<span class="p">,</span>Z <span class="o">=</span> <span class="kc">NULL</span><span class="p">){</span>
        P <span class="o">=</span> <span class="kp">dim</span><span class="p">(</span>X<span class="p">)[</span><span class="m">2</span><span class="p">]</span>
        <span class="kr">if</span> <span class="p">(</span><span class="o">!</span><span class="kp">is.null</span><span class="p">(</span>Z<span class="p">))</span> <span class="p">{</span>
            y <span class="o">=</span> lm<span class="p">(</span>y<span class="o">~</span>Z<span class="p">)</span><span class="o">$</span>residuals
        <span class="p">}</span>
        output <span class="o">=</span> <span class="kt">matrix</span><span class="p">(</span><span class="m">0</span><span class="p">,</span>nrow <span class="o">=</span> P<span class="p">,</span>ncol <span class="o">=</span> <span class="m">2</span><span class="p">)</span>
        <span class="kr">for</span><span class="p">(</span>i <span class="kr">in</span> <span class="m">1</span><span class="o">:</span>P<span class="p">){</span>
          g <span class="o">=</span> <span class="kp">summary</span><span class="p">(</span>lm<span class="p">(</span>y <span class="o">~</span> X<span class="p">[,</span>i<span class="p">]))</span>
          output<span class="p">[</span>i<span class="p">,]</span> <span class="o">=</span> g<span class="o">$</span>coefficients<span class="p">[</span><span class="m">2</span><span class="p">,</span><span class="m">1</span><span class="o">:</span><span class="m">2</span><span class="p">]</span>
        <span class="p">}</span>
        <span class="kr">return</span><span class="p">(</span><span class="kt">list</span><span class="p">(</span>betahat <span class="o">=</span> output<span class="p">[,</span><span class="m">1</span><span class="p">],</span> sebetahat <span class="o">=</span> output<span class="p">[,</span><span class="m">2</span><span class="p">],</span> 
                    residuals <span class="o">=</span> y<span class="p">))</span>
    <span class="p">}</span>
lasso_reorder <span class="o">=</span> <span class="kr">function</span><span class="p">(</span>X<span class="p">,</span> y<span class="p">)</span> <span class="p">{</span>
        <span class="c1"># perform lasso regression and reorder regressors by &quot;importance&quot;</span>
        fit.glmnet <span class="o">&lt;-</span> glmnet<span class="o">::</span>glmnet<span class="p">(</span>X<span class="p">,</span> y<span class="p">,</span> intercept <span class="o">=</span> <span class="bp">F</span><span class="p">)</span>
        beta_path <span class="o">=</span> coef<span class="p">(</span>fit.glmnet<span class="p">)[</span><span class="m">-1</span><span class="p">,]</span>
        K <span class="o">=</span> <span class="kp">dim</span><span class="p">(</span>beta_path<span class="p">)[</span><span class="m">2</span><span class="p">]</span>
        path_order <span class="o">=</span> <span class="kt">c</span><span class="p">()</span>
        <span class="kr">for</span> <span class="p">(</span>k <span class="kr">in</span> <span class="m">1</span><span class="o">:</span>K<span class="p">)</span> <span class="p">{</span>
            crt_path <span class="o">=</span> <span class="kp">which</span><span class="p">(</span>beta_path<span class="p">[,</span>k<span class="p">]</span> <span class="o">!=</span> <span class="m">0</span><span class="p">)</span>
            <span class="kr">if</span> <span class="p">(</span><span class="kp">length</span><span class="p">(</span>crt_path<span class="p">)</span> <span class="o">!=</span> <span class="m">0</span> <span class="o">&amp;</span> <span class="kp">length</span><span class="p">(</span>path_order<span class="p">)</span> <span class="o">==</span> <span class="m">0</span><span class="p">)</span> <span class="p">{</span>
                path_order <span class="o">=</span> <span class="kt">c</span><span class="p">(</span>path_order<span class="p">,</span> crt_path<span class="p">)</span>
            <span class="p">}</span> <span class="kr">else</span> <span class="kr">if</span><span class="p">(</span><span class="kp">length</span><span class="p">(</span>crt_path<span class="p">)</span> <span class="o">!=</span> <span class="m">0</span><span class="p">)</span> <span class="p">{</span>
                path_order <span class="o">=</span> <span class="kt">c</span><span class="p">(</span>path_order<span class="p">,</span> crt_path<span class="p">[</span><span class="o">-</span><span class="kp">which</span><span class="p">(</span>crt_path <span class="o">%in%</span> path_order<span class="p">)]</span> <span class="p">)</span>
            <span class="p">}</span>
        <span class="p">}</span>
        path_order <span class="o">=</span> <span class="kp">unname</span><span class="p">(</span>path_order<span class="p">)</span>
        index_order <span class="o">=</span> <span class="kt">c</span><span class="p">(</span>path_order<span class="p">,</span> <span class="kp">seq</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="kp">dim</span><span class="p">(</span>beta_path<span class="p">)[</span><span class="m">1</span><span class="p">])[</span><span class="o">-</span>path_order<span class="p">])</span>
        <span class="kr">return</span><span class="p">(</span>index_order<span class="p">)</span>
    <span class="p">}</span>
<span class="c1"># compute fitted values from varbvsmix </span>
fitfv <span class="o">=</span> <span class="kr">function</span><span class="p">(</span>X<span class="p">,</span>Z<span class="p">,</span>fit<span class="p">){</span>
  bhat <span class="o">=</span> <span class="kp">rowSums</span><span class="p">(</span>fit<span class="o">$</span>alpha<span class="o">*</span>fit<span class="o">$</span>mu<span class="p">)</span>
  <span class="kr">return</span><span class="p">(</span>X <span class="o">%*%</span> bhat <span class="o">+</span> fit<span class="o">$</span>mu.cov<span class="p">[</span><span class="m">1</span><span class="p">]</span> <span class="o">+</span> Z <span class="o">%*%</span> fit<span class="o">$</span>mu.cov<span class="p">[</span><span class="m">-1</span><span class="p">])</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
        </div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Core-analysis">Core analysis<a class="anchor-link" href="#Core-analysis">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[5]:</div><div class="hidden_content">
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-r"><pre><span></span>input_file <span class="o">=</span> <span class="s">&quot;../data/Thyroid.FMO2.1Mb.RDS&quot;</span>
dat <span class="o">=</span> <span class="kp">readRDS</span><span class="p">(</span>input_file<span class="p">)</span>
X <span class="o">=</span> <span class="kp">as.matrix</span><span class="p">(</span>dat<span class="o">$</span>X<span class="p">)</span>
X <span class="o">=</span> X<span class="p">[,</span><span class="kp">which</span><span class="p">(</span><span class="kp">colSums</span><span class="p">(</span>X<span class="p">)</span><span class="o">!=</span><span class="m">0</span><span class="p">)]</span>
<span class="kp">storage.mode</span><span class="p">(</span>X<span class="p">)</span> <span class="o">&lt;-</span> <span class="s">&quot;double&quot;</span>
y <span class="o">=</span> <span class="kp">as.vector</span><span class="p">(</span>dat<span class="o">$</span>y<span class="p">)</span>
Z <span class="o">=</span> <span class="kp">as.matrix</span><span class="p">(</span>dat<span class="o">$</span>Z<span class="p">)</span>
<span class="c1"># univariate results</span>
initial <span class="o">=</span> univariate_regression<span class="p">(</span>X<span class="p">,</span> y <span class="p">,</span>Z<span class="p">)</span>
mixsd <span class="o">=</span> autoselect.mixsd<span class="p">(</span>initial<span class="o">$</span>betahat<span class="p">,</span> initial<span class="o">$</span>sebetahat<span class="p">)</span>
mu_zero <span class="o">=</span> <span class="kt">matrix</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> ncol <span class="o">=</span> <span class="kp">length</span><span class="p">(</span>mixsd<span class="p">)</span><span class="m">+1</span><span class="p">,</span> nrow <span class="o">=</span> <span class="kp">ncol</span><span class="p">(</span>X<span class="p">))</span>
alpha_zero <span class="o">=</span> <span class="kt">matrix</span><span class="p">(</span><span class="m">1</span><span class="o">/</span><span class="kp">ncol</span><span class="p">(</span>X<span class="p">),</span> ncol <span class="o">=</span> <span class="kp">length</span><span class="p">(</span>mixsd<span class="p">)</span><span class="m">+1</span><span class="p">,</span>nrow <span class="o">=</span> <span class="kp">ncol</span><span class="p">(</span>X<span class="p">))</span>
alpha_zero<span class="p">[,</span><span class="m">1</span><span class="p">]</span> <span class="o">=</span> <span class="m">1</span> <span class="o">-</span> <span class="kp">length</span><span class="p">(</span>mixsd<span class="p">)</span> <span class="o">/</span> <span class="kp">ncol</span><span class="p">(</span>X<span class="p">)</span>
index_order <span class="o">=</span> lasso_reorder<span class="p">(</span>X<span class="p">,</span> initial<span class="o">$</span>residuals<span class="p">)</span>
<span class="c1"># bvsmix with lasso init vs random init</span>
fit11 <span class="o">=</span> varbvs<span class="o">::</span>varbvsmix<span class="p">(</span>X<span class="p">[,</span> index_order<span class="p">],</span> 
                         Z<span class="p">,</span> y<span class="p">,</span> sa <span class="o">=</span> <span class="kt">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span>mixsd<span class="o">^</span><span class="m">2</span><span class="p">),</span>
                         mu <span class="o">=</span> mu_zero<span class="p">,</span>
                         alpha <span class="o">=</span> alpha_zero<span class="p">,</span>
                         verbose <span class="o">=</span> <span class="bp">F</span><span class="p">)</span>
fit12 <span class="o">=</span> varbvs<span class="o">::</span>varbvsmix<span class="p">(</span>X<span class="p">,</span> 
                         Z<span class="p">,</span> y<span class="p">,</span> sa <span class="o">=</span> <span class="kt">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span>mixsd<span class="o">^</span><span class="m">2</span><span class="p">),</span>
                         mu <span class="o">=</span> mu_zero<span class="p">,</span>
                         alpha <span class="o">=</span> alpha_zero<span class="p">,</span>
                         verbose <span class="o">=</span> <span class="bp">F</span><span class="p">)</span>
<span class="c1"># bvsmix with lasso init vs random init</span>
fit21 <span class="o">=</span> varbvs<span class="o">::</span>varbvs<span class="p">(</span>X<span class="p">[,</span> index_order<span class="p">],</span> Z<span class="p">,</span> y<span class="p">,</span> verbose <span class="o">=</span> <span class="bp">F</span><span class="p">)</span>
fit22 <span class="o">=</span> varbvs<span class="o">::</span>varbvs<span class="p">(</span>X<span class="p">,</span> Z<span class="p">,</span> y<span class="p">,</span> verbose <span class="o">=</span> <span class="bp">F</span><span class="p">)</span>
</pre></div>
</div>
</div>
        </div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Check-top-hits-with-lasso-init">Check top hits with lasso init<a class="anchor-link" href="#Check-top-hits-with-lasso-init">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[10]:</div><div class="hidden_content">
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-r"><pre><span></span>mix.top <span class="o">=</span> <span class="kp">names</span><span class="p">(</span><span class="kp">sort</span><span class="p">(</span>fit11<span class="o">$</span>lfsr<span class="p">)[</span><span class="m">1</span><span class="o">:</span><span class="m">5</span><span class="p">])</span>
<span class="kp">cbind</span><span class="p">(</span><span class="m">1</span> <span class="o">-</span> fit11<span class="o">$</span>lfsr<span class="p">[</span>mix.top<span class="p">],</span> fit21<span class="o">$</span>alpha<span class="p">[,</span><span class="m">1</span><span class="p">][</span>mix.top<span class="p">])</span>
</pre></div>
</div>
</div>
        </div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="hidden_content">
<div class="output_area">
<div class="prompt"></div>
<div class="output_html rendered_html output_subarea ">
<table>
<tbody>
	<tr><th scope=row>chr1_171172098_C_T_b38</th><td>1.0000000   </td><td>1.000000e+00</td></tr>
	<tr><th scope=row>chr1_171122735_A_G_b38</th><td>1.0000000   </td><td>5.487233e-03</td></tr>
	<tr><th scope=row>chr1_171190872_G_A_b38</th><td>0.4840977   </td><td>1.914644e-05</td></tr>
	<tr><th scope=row>chr1_171219393_T_A_b38</th><td>0.4827524   </td><td>2.446686e-05</td></tr>
	<tr><th scope=row>chr1_171178705_A_G_b38</th><td>0.4825416   </td><td>2.025885e-05</td></tr>
</tbody>
</table>
</div>
</div>
        </div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[11]:</div><div class="hidden_content">
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-r"><pre><span></span>bvs.top <span class="o">=</span> <span class="kp">names</span><span class="p">(</span><span class="kp">sort</span><span class="p">(</span>fit21<span class="o">$</span>alpha<span class="p">[,</span><span class="m">1</span><span class="p">],</span> decreasing<span class="o">=</span><span class="bp">T</span><span class="p">)[</span><span class="m">1</span><span class="o">:</span><span class="m">5</span><span class="p">])</span>
<span class="kp">cbind</span><span class="p">(</span><span class="m">1</span> <span class="o">-</span> fit11<span class="o">$</span>lfsr<span class="p">[</span>bvs.top<span class="p">],</span> fit21<span class="o">$</span>alpha<span class="p">[,</span><span class="m">1</span><span class="p">][</span>bvs.top<span class="p">])</span>
</pre></div>
</div>
</div>
        </div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="hidden_content">
<div class="output_area">
<div class="prompt"></div>
<div class="output_html rendered_html output_subarea ">
<table>
<tbody>
	<tr><th scope=row>chr1_171172098_C_T_b38</th><td>1.0000000 </td><td>0.99999999</td></tr>
	<tr><th scope=row>chr1_171133158_A_G_b38</th><td>0.4573966 </td><td>0.99999951</td></tr>
	<tr><th scope=row>chr1_171199984_T_C_b38</th><td>0.4605322 </td><td>0.99843224</td></tr>
	<tr><th scope=row>chr1_171252314_G_C_b38</th><td>0.4608848 </td><td>0.03124062</td></tr>
	<tr><th scope=row>chr1_171150061_G_C_b38</th><td>0.4147678 </td><td>0.01524914</td></tr>
</tbody>
</table>
</div>
</div>
        </div>
</div>
</div>
</div>
<hr>
&copy 2015-2017 Gao Wang et al at Stephens Lab, University of Chicago
<p><small>Exported from <a href="http://github.com/stephenslab/gtex-eqtls/blob/1b81e25eceabbcdf891ea25069e8fd784409f086/analysis/20171027_BVS_MR_ASH.ipynb"><code>analysis/20171027_BVS_MR_ASH.ipynb</code></a> committed by Gao Wang on Fri Oct 27 10:06:28 2017 <a href="http://github.com/stephenslab/gtex-eqtls/commit/1b81e25eceabbcdf891ea25069e8fd784409f086">revision 1, 1b81e25</a> <a href="https://stephenslab.github.io/ipynb-website/notes.html#Note-about-commit-ids"><span class="fa fa-question-circle"></span></a></small></p>
</div>
</div>
</body>
</html>
