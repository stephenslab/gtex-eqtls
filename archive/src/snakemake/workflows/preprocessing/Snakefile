"""
Processing for eQTL analysis

This pipeline provides routines to properly format summary
statistics data generated from Matrix-EQTL into manageable
data sets in HDF5 format. A routine to create a toy example
for comparison of summary statistics generated by eqtlbma vs.
Matrix-EQTL is also included.
"""
__author__ = "Gao Wang"
# use a modified version of shell.py from snakemake
from shell import shell

# Global settings
configfile: "config.yaml"

if config["IsCluster"] == "F":
    shell.executable("/bin/bash")
    shell.prefix(config["ConfigBash"])
else:
    shell.prefix('''
    echo """#!/bin/bash
    {0}
    '''.format(config["ConfigBash"]))
    shell.suffix('''""" {1} {0}'''.format(config["ConfigCluster"].replace("LOGDIR", config["LogDir"]),
                                          "|" if config["ConfigCluster"] else ''))
    shell.echo(True)

# Rules
include: "../../rules/sumstat-to-h5.rules"
include: "../../rules/file-processing.rules"
include: "../../rules/matrix-eqtl.rules"
include: "../../rules/lite-input.rules"

rule clean_tmp:
  shell: "rm -rf {config[TmpDir]}/*"

rule clean_log:
  shell: "rm -rf {config[LogDir]}/*"
