nBatches = 2000

rule eqtlbma_batch_poisson:
  input:
    config["ConfDir"] + "/eqtlbma.quasipoisson.txt"
  output:
    config["TmpDir"] + "/eqtlbma_batch_poisson.out"
  run:
    for i in range(1, nBatches):
      shell('''
      python {config[SrcDir]}/python/analysis_admin.py eqtlbma_batch \
      -g {config[InputDir]}/tss_coords.bed.gz \
      -s {config[InputDir]}/snp_coords.bed.gz \
      -n {nBatches} -b {i} -e {config[bma_bf]} -a {input}
      ''')
    shell('touch {output}')